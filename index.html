<!DOCTYPE html>
<meta charset="utf8" />
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<html>
  <title>beeps every 30 seconds</title>
  <body>
      <style>
          #muteButton {
              width: 8rem;
              height: 8rem;
          }
      </style>
    <h1>Current second number: <span id="timestamp"></span></h1>
    <h2>Beeping in <span id="time-remaining"></span></h2>

    <button id="muteButton">ðŸ”‡ Currently muted. Click this to enable.</button>

    <audio id="beep" src="beep.wav"></audio>
    <audio id="silentLoop" src="empty.wav" loop></audio>

    Time synchronization provided by
    <a href="https://time.is/" id="time_is_link" rel="nofollow">time.is</a>

    <script src="https://widget.time.is/t.js"></script>
    <script>
      const remainingSpan = document.getElementById("time-remaining");
      const muteButton = document.getElementById("muteButton");
      const silentLoop = document.getElementById("silentLoop");
      const beep = document.getElementById("beep");

      let isMuted = true;
      muteButton.addEventListener("click", () => {
        isMuted = !isMuted;
        sound.mute(isMuted);
        if (isMuted) {
          muteButton.innerHTML = "ðŸ”‡ Currently muted. Click this to unmute.";
          silentLoop.pause();
        } else {
          muteButton.innerHTML = "ðŸ”Š Currently unmuted. Click this to mute.";
          silentLoop.play();
        }
      });

      function renderCallback(renderedTimestamp) {
        const time = parseInt(
          decodeURIComponent(renderedTimestamp).match(/\>(\d+)\</)[1]
        );
        if (time === 0 || time === 30) {
          if (!isMuted) {
            beep.play();
          }
        }
        remainingSpan.innerHTML = 30 - (time % 30);
      }

      time_is_widget.init({
        timestamp: {
          id: "Seattle_z14e",
          callback: "renderCallback",
          time_format: "seconds",
          template: "TIME",
        },
      });
    </script>
  </body>
</html>
