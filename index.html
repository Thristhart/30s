<!DOCTYPE html>
<meta charset="utf8" />
<html>
  <title>beeps every 30 seconds</title>
  <body>
    <h1>Current second number: <span id="timestamp"></span></h1>
    <h2>Beeping in <span id="time-remaining"></span></h2>
    
    
    <button id="muteButton">ðŸ”‡ Currently muted. Click this to enable.</button>

    Time synchronization provided by
    <a href="https://time.is/" id="time_is_link" rel="nofollow">time.is</a>



    <script src="https://widget.time.is/t.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/howler@2.2.0/dist/howler.min.js"
      integrity="sha256-Tp/HPdYebMPmgPDCAs8Et4j+VUKuOWmAZdhegRS4O4g="
      crossorigin="anonymous"
    ></script>
    <script>
      const sound = new Howl({
        src: ["beep.wav"],
        mute: true,
      });
      const remainingSpan = document.getElementById("time-remaining");
      const muteButton = document.getElementById("muteButton");

    let isMuted = true;
      muteButton.addEventListener("click", () => {
        isMuted = !isMuted;
            sound.mute(isMuted);
        if(isMuted) {
            muteButton.innerHTML = "ðŸ”‡ Currently muted. Click this to unmute.";
        }
        else {
            muteButton.innerHTML = "ðŸ”Š Currently unmuted. Click this to mute.";
        }
      })


      function renderCallback(renderedTimestamp) {
        const time = parseInt(
          decodeURIComponent(renderedTimestamp).match(/\>(\d+)\</)[1]
        );
        if (time === 0 || time === 30) {
            if(!isMuted) {
                sound.play();
            }
        }
        remainingSpan.innerHTML = 30 - (time % 30);
      }

      time_is_widget.init({
        timestamp: {
          id: "Seattle_z14e",
          callback: "renderCallback",
          time_format: "seconds",
          template: "TIME",
        },
      });
    </script>
  </body>
</html>
